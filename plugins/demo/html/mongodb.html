<div class="layui-fluid">
    <div class="layui-col-md12" style="padding: 5px;">
        <div class="layui-card">
            <div class="layui-card-body">
                <div id="list"></div>
            </div>
        </div>
    </div>
</div>

<script type="text/javascript">

layui.config({base: '{__STATIC__}/admin/layuiadmin/'}).use(['table','jquery','laytpl'], function(){
///
var admin = layui.admin
,$ = layui.$
,form = layui.form
,table = layui.table;


table.render({
    elem: '#list',
    url: '/plugin/data?name=demo&action=list',
    method:"POST",
    request:{
        pageName: 'page', // 页码的参数名称，默认：page
        limitName: 'limit'
    },
    title: '数据表',
    cols: [[
        {field:'_id', title:'ID',width:250},
        {field:'time', title:'时间',width:130},
        {field:'content', title:'内容'},
        {title:'操作', toolbar: '#cmdTpl', width:90, fixed: 'right'}
     ]],
    page: true
});

table.on('tool(list)', function(obj){
    switch(obj.event){
        case 'push':push(obj);break;
    };
});


function push(obj){
    layer.confirm('你真的要PUSH吗?', { closeBtn: 2, icon: 3 }, function() {
        $.post('/plugin/data?name=demo&action=push', {'args':{'msg':obj.data.id}}, function(data) {
            showMsg(data.msg,function(){
                if (data.code>-1){
                    location.reload();
                }
            },{icon:data.code>-1?1:2});
        },'json');
    });
}

///
});
</script>


<script type="text/html" id="cmdTpl">
    <a class="layui-btn layui-btn-danger layui-btn-xs" lay-event="push">PUSH</a>
</script>
